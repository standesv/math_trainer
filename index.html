<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="theme-color" content="#0b5cff" />
  <meta name="description" content="Entra√Ænement aux additions et soustractions - 10 questions par partie" />

  <link rel="manifest" href="manifest.webmanifest" />
  <link rel="stylesheet" href="styles.css" />

  <title>Math Trainer</title>
</head>

<body>
  <header class="app-header">
    <div class="brand">
      <div class="logo" aria-hidden="true">¬±</div>
      <div>
        <h1>Math Trainer</h1>
        <p class="subtitle">Additions & soustractions</p>
      </div>
    </div>
    <button id="installBtn" class="btn btn-ghost" hidden>Installer</button>
  </header>

  <main class="container">
    <!-- Accueil -->
    <section id="screen-home" class="card card-home">
      <div class="home-top">
        <div class="field">
          <label for="profileSelect">Qui joue ?</label>
          <div class="row">
            <select id="profileSelect" class="input">
              <!-- JS -->
            </select>
            <button type="button" id="addProfileBtn" class="btn btn-ghost btn-icon" aria-label="Ajouter un profil">Ôºã</button>
          </div>
        </div>

        <div class="field">
          <label>Choisis ton jeu</label>
          <div class="segmented segmented-big" role="group" aria-label="Mode">
            <button type="button" class="seg active" data-mode="mix">Mix</button>
            <button type="button" class="seg" data-mode="add">+</button>
            <button type="button" class="seg" data-mode="sub">‚àí</button>
            <button type="button" class="seg" data-mode="tables">Tables</button>
          </div>
          <small id="modeHint">Mix = additions et soustractions</small>
        </div>

        <button id="startBtn" class="btn btn-primary btn-xl">‚ñ∂Ô∏è D√©marrer (10 questions)</button>

        <div class="home-actions">
          <button id="openSettingsBtn" class="btn btn-ghost btn-xl">‚öôÔ∏è R√©glages</button>
          <button id="resetHistoryBtn" class="btn btn-ghost btn-xl">üßΩ Effacer les scores</button>
        </div>
      </div>
    </section>

    <!-- Jeu -->
    <section id="screen-game" class="card" hidden>
      <div class="row-between">
        <div>
          <h2>Question <span id="qIndex">1</span>/<span id="qTotal">10</span></h2>
          <p class="muted">R√©ponds puis valide.</p>
        </div>
        <div class="pill">
          ‚úÖ <span id="okCount">0</span> &nbsp;|&nbsp; ‚ùå <span id="errCount">0</span>
        </div>
      </div>

      <div class="row-between row-tight">
        <div class="pill pill-mono">‚è±Ô∏è <span id="timer">00:00</span></div>
        <div class="pill pill-mono">‚è±Ô∏è <span id="avgPerQ">0.0</span> s/question</div>
      </div>

      <div class="problem" aria-live="polite">
        <span id="a">0</span>
        <span id="op">+</span>
        <span id="b">0</span>
        <span class="eq">=</span>
        <span class="box">
          <input id="answerInput" inputmode="numeric" autocomplete="off" />
        </span>
      </div>

      <div class="feedback" id="feedback" aria-live="polite"></div>

      <div class="actions actions-big">
        <button id="validateBtn" class="btn btn-primary btn-xl">‚úÖ Valider</button>
        <button id="skipBtn" class="btn btn-ghost btn-xl">‚è≠Ô∏è Passer</button>
        <button id="stopBtn" class="btn btn-danger btn-xl">‚èπÔ∏è Stop</button>
      </div>
    </section>

    <!-- R√©sultats -->
    <section id="screen-results" class="card" hidden>
      <h2>R√©sultat</h2>

      <div class="summary">
        <div class="metric">
          <div class="metric-label">R√©ussites</div>
          <div class="metric-value" id="finalOk">0</div>
        </div>
        <div class="metric">
          <div class="metric-label">Erreurs</div>
          <div class="metric-value" id="finalErr">0</div>
        </div>
        <div class="metric">
          <div class="metric-label">Score</div>
          <div class="metric-value" id="finalScore">0%</div>
        </div>
      </div>

      <p id="timeSummary" class="muted" style="margin-top:10px;"></p>

      <details class="details">
        <summary>Voir le corrig√©</summary>
        <div id="reviewList" class="review"></div>
      </details>

      <div class="actions actions-big">
        <button id="playAgainBtn" class="btn btn-primary btn-xl">üîÅ Rejouer</button>
        <button id="backHomeBtn" class="btn btn-ghost btn-xl">üè† Accueil</button>
      </div>
    </section>

    <!-- Historique -->
    <section class="card">
      <div class="row-between">
        <h2>Derniers scores</h2>
        <span class="muted" id="historyHint">Sur cet appareil</span>
      </div>

      <div class="table-wrap">
        <table class="table" aria-label="Historique des parties">
          <thead>
            <tr>
              <th>Date</th>
              <th>Mode</th>
              <th>Niveau</th>
              <th>Q</th>
              <th>‚úÖ</th>
              <th>‚ùå</th>
              <th>Score</th>
            </tr>
          </thead>
          <tbody id="historyBody"></tbody>
        </table>
      </div>
    </section>

    <footer class="footer muted">
      Astuce : installe l‚Äôapp pour l‚Äôutiliser hors-ligne.
    </footer>
  </main>

  <!-- Modal R√©glages -->
  <div id="settingsModal" class="modal" aria-hidden="true" role="dialog" aria-label="R√©glages">
    <div class="modal-backdrop" data-close></div>
    <div class="modal-sheet" role="document">
      <div class="modal-header">
        <h2 style="margin:0;">R√©glages</h2>
        <button class="btn btn-ghost btn-icon" id="closeSettingsBtn" aria-label="Fermer">‚úï</button>
      </div>

      <div class="modal-body">
        <div class="field">
          <label for="questionsCount">Nombre de questions</label>
          <input id="questionsCount" class="input" type="number" min="5" max="50" step="1" value="10" />
        </div>

        <div class="field">
          <label for="maxValue">Niveau (0 ‚Üí max)</label>
          <input id="maxValue" class="input" type="number" min="5" max="200" step="1" value="20" />
          <small>Si ‚ÄúProgression‚Äù est activ√©e, ce max est plafonn√© au niveau d√©bloqu√©.</small>
        </div>

        <div class="field">
          <label class="check">
            <input id="allowNegative" type="checkbox" />
            Autoriser des r√©sultats n√©gatifs (soustraction)
          </label>
        </div>

        <details class="details details-compact">
          <summary>Tables</summary>
          <div class="subgrid">
            <label class="check">
              <input id="tablesEnabled" type="checkbox" />
              Activer le mode tables
            </label>

            <div class="field">
              <label for="tableNumber">Table</label>
              <input id="tableNumber" class="input" type="number" min="1" max="20" step="1" value="7" />
            </div>

            <div class="field">
              <label for="tablesOp">Op√©ration</label>
              <select id="tablesOp" class="input">
                <option value="add">Addition</option>
                <option value="sub">Soustraction</option>
              </select>
            </div>
          </div>
        </details>

        <details class="details details-compact">
          <summary>Progression</summary>
          <div class="subgrid">
            <label class="check">
              <input id="progressEnabled" type="checkbox" checked />
              Activer la progression
            </label>

            <div class="pill pill-mono">
              Niveau max d√©bloqu√© : <span id="unlockedMax">10</span>
            </div>

            <button type="button" id="resetProgressBtn" class="btn btn-ghost btn-xl">R√©initialiser la progression</button>
          </div>
        </details>

        <details class="details details-compact">
          <summary>Effets</summary>
          <div class="subgrid">
            <label class="check">
              <input id="soundEnabled" type="checkbox" checked />
              Sons
            </label>
            <label class="check">
              <input id="confettiEnabled" type="checkbox" checked />
              Confettis
            </label>
          </div>
        </details>

        <details class="details details-compact">
          <summary>Gestion des profils</summary>
          <div class="subgrid">
            <button type="button" id="renameProfileBtn" class="btn btn-ghost btn-xl">Renommer le profil</button>
            <button type="button" id="deleteProfileBtn" class="btn btn-danger btn-xl">Supprimer le profil</button>
          </div>
        </details>
      </div>

      <div class="modal-footer">
        <button id="saveSettingsBtn" class="btn btn-primary btn-xl">OK</button>
      </div>
    </div>
  </div>

  <script src="app.js"></script>
</body>
</html>
